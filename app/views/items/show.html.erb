<%= render partial: 'search', locals: { item: @item } %>

<section>
  <% unless @item.image.blank? %>
    <div class="image">
      <%= image_tag(@item.image) %>
    </div>
  <% end %>

  <table class="properties">
    <% item_properties(@item) do |key, value| %>
      <tr>
        <td><%= key %>:</td>
        <td><%= value %></td>
      </tr>
    <% end %>
  </table>
</section>

<section>
  <div class="list">
    <% if @item.orders(true).any? %>
      <table data-sort class="hover">
        <thead>
          <tr>
            <th data-sort><%= t("activerecord.attributes.order.price") %></th>
            <th data-sort data-sort-desc><%= t("activerecord.attributes.order.quality") %></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @item.orders(true).each do |order| %>
            <%= item_order_row(order) %>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <% if @item.alternative.blank? %>
        <%= t(:no_one_is_selling, name: @item.name) %>
      <% else %>
        <%= t(:no_one_is_selling_with_alternative_html, name: @item.name, alternative: alternative_link(@item)) %>
      <% end %>
    <% end %>
  </div>

  <div class="new-order">
    <% if signed_in? %>
      <%= standard_form_for([@item, @order]) do |f| %>
        <fieldset>
          <legend><%= t(:place_sell_order) %></legend>
          <%= f.price %>
          <%= f.quality %>
          <%= f.submit %>
        </fieldset>
      <% end %>
    <% else %>
      <% if @item.orders(true).any? %>
        <%= link_to t(:must_be_signed_in_to_sell_or_buy, item: @item.name), sign_in_user_path %>
      <% else %>
        <%= link_to t(:must_be_signed_in_to_sell, item: @item.name), sign_in_user_path %>
      <% end %>
    <% end %>
  </div>
</section>
